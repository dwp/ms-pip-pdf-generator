{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "$id": "https://gitlab.com/dwp/health/pip-apply/schemas/registration/registration.schema.1.0.0.json",
  "title": "Registration Schema",
  "description": "Schema to describe the complete data structure for the registration component of the pip-apply application schema.",
  "type": "object",
  "properties": {
    "additionalSupport": {
      "description": "The additional support section of the registration data",
      "type": "object",
      "properties": {
        "helpCommunicating": {
          "description": "Do you need help from someone else to communicate with us?",
          "type": "boolean",
          "examples": [
            true,
            false
          ]
        },
        "helpUnderstandingLetters": {
          "description": "Do you need help to fill in forms or understand letters?",
          "type": "boolean",
          "examples": [
            true,
            false
          ]
        },
        "helperDetails": {
          "description": "The first name and surname of the person helping the claimant fill in the form.",
          "type": "object",
          "properties": {
            "surname": {
              "type": "string",
              "pattern": "^[ -~]+$",
              "maxLength": 100,
              "examples": [
                "Helper Joe",
                "Helper Jane"
              ]
            },
            "firstname": {
              "type": "string",
              "pattern": "^[ -~]+$",
              "maxLength": 100,
              "examples": [
                "Helper Bloggs"
              ]
            }
          },
          "required": [
            "surname",
            "firstname"
          ]
        }
      },
      "required": [
        "helpCommunicating",
        "helpUnderstandingLetters"
      ]
    },
    "personalDetails": {
      "type": "object",
      "description": "The personal details section of the registration data",
      "properties": {
        "surname": {
          "description": "The claimant's surname",
          "type": "string",
          "pattern": "^[ -~]+$",
          "maxLength": 35,
          "minLength": 1,
          "examples": [
            "Claimant"
          ]
        },
        "firstname": {
          "description": "The claimant's first name",
          "type": "string",
          "pattern": "^[ -~]+$",
          "maxLength": 35,
          "minLength": 1,
          "examples": [
            "Bob",
            "Alice"
          ]
        },
        "nino": {
          "description": "The claimant's nino",
          "type": "string",
          "pattern": "^(?!BG|GB|NK|KN|TN|NT|ZZ)[ABCEGHJ-PRSTW-Z][ABCEGHJ-NPRSTW-Z]\\d{6}[A-D]$",
          "maxLength": 9,
          "examples": [
            "AA111111A"
          ]
        },
        "dob": {
          "description": "The claimant's date of birth",
          "type": "string",
          "format": "date",
          "examples": [
            "2001-01-01"
          ]
        },
        "address": {
          "description": "The claimant's address",
          "$ref": "address.schema.1.0.0.json"
        },
        "alternativeAddress": {
          "description": "The claimant's address",
          "$ref": "address.schema.1.0.0.json"
        },
        "contact": {
          "description": "The claimant's contact details",
          "type": "object",
          "properties": {
            "mobileNumber": {
              "type": "string",
              "pattern": "^07\\d{9}$",
              "examples": [
                "07123123123"
              ]
            },
            "alternativeNumber": {
              "type": "string",
              "pattern": "^0(?:\\d{10}|\\d{9})$",
              "examples": [
                "01234567891"
              ]
            },
            "textphone": {
              "type": "string",
              "pattern": "^0(?:\\d{10}|\\d{9})$",
              "examples": [
                "01234567891"
              ]
            },
            "smsUpdates": {
              "description": "receive updates on the progress of the application via sms",
              "type": "boolean"
            }
          },
          "required": [
            "mobileNumber",
            "smsUpdates"
          ]
        },
        "alternateFormat": {
          "type": "object",
          "properties": {
            "formatType": {
              "type": "string",
              "enum": [
                "braille",
                "signLanguage",
                "audio",
                "other"
              ],
              "examples": [
                "braille"
              ]
            }
          },
          "oneOf": [
            {
              "properties": {
                "formatType": {
                  "const": "braille"
                },
                "brailleOptions": {
                  "type": "string",
                  "enum": [
                    "type1Uncontracted",
                    "type2Contracted"
                  ]
                }
              },
              "required": [
                "brailleOptions"
              ],
              "additionalProperties": false
            },
            {
              "properties": {
                "formatType": {
                  "const": "signLanguage"
                },
                "signLanguageOptions": {
                  "type": "string",
                  "enum": [
                    "britishDvd",
                    "britishMpeg",
                    "irishDvd",
                    "irishMpeg"
                  ]
                }
              },
              "required": [
                "signLanguageOptions"
              ],
              "additionalProperties": false
            },
            {
              "properties": {
                "formatType": {
                  "const": "audio"
                },
                "audioOptions": {
                  "type": "string",
                  "enum": [
                    "cassette",
                    "cd",
                    "dvd",
                    "mp3"
                  ]
                }
              },
              "required": [
                "audioOptions"
              ]
            },
            {
              "properties": {
                "formatType": {
                  "const": "other"
                },
                "otherOptions": {
                  "type": "string",
                  "enum": [
                    "colouredPaper",
                    "largePrint16Font",
                    "largePrintCustomFont",
                    "accessiblePDF",
                    "email",
                    "other"
                  ]
                },
                "alternateFormatAdditionalInfo": {
                  "type": "string",
                  "pattern": "^[ -~]+$",
                  "maxLength": 240
                }
              },
              "required": [
                "otherOptions"
              ],
              "additionalProperties": false
            }
          ]
        }
      },
      "required": [
        "surname",
        "firstname",
        "nino",
        "dob",
        "address",
        "contact"
      ]
    },
    "residenceAndPresence": {
      "description": "questions about residence and presence in the UK",
      "type": "object",
      "properties": {
        "nationality": {
          "description": "The claimant's nationality",
          "$ref": "nationality.schema.1.0.0.json"
        },
        "residentBeforeBrexit": {
          "type": "string",
          "enum": [
            "Yes",
            "No",
            "Don't know"
          ]
        },
        "inUkTwoOutOfThreeYears": {
          "type": "string",
          "enum": [
            "Yes",
            "No",
            "Don't know"
          ]
        },
        "receivingPensionsOrBenefitsFromEEA": {
          "type": "boolean"
        },
        "payingInsuranceEEA": {
          "type": "boolean"
        }
      },
      "required": [
        "nationality"
      ]
    },
    "aboutYourHealth": {
      "description": "section to capture details relating to health conditions, health professionals and healthcare residence",
      "type": "object",
      "properties": {
        "healthConditions": {
          "description": "A list of health conditions",
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "pattern": "^[ -~]+$",
            "maxLength": 200,
            "examples": [
              "broken arm"
            ]
          }
        },
        "hcpContactConsent": {
          "description": "Can the Department for Work and Pensions contact any health professionals for information about you?",
          "type": "boolean"
        },
        "hcpShareConsent": {
          "description": "Do you agree that your health professionals can share relevant information about your health conditions to support your application?",
          "type": "boolean"
        },
        "healthProfessionalsDetails": {
          "description": "A list of health professionals",
          "type": "array",
          "items": {
            "$ref": "#/$defs/healthProfessionalsDetails"
          }
        },
        "hospitalHospiceOrCarehome": {
          "type": "object",
          "properties": {
            "accommodationType": {
              "type": "string",
              "enum": [
                "hospital",
                "hospice",
                "carehome",
                "other",
                "none"
              ],
              "examples": [
                "hospice"
              ]
            }
          },
          "oneOf": [
            {
              "properties": {
                "accommodationType": {
                  "const": "hospital"
                },
                "accommodationName": {
                  "description": "The name of the hospital",
                  "type": "string",
                  "maxLength": 35,
                  "minLength": 3,
                  "examples": [
                    "The Lady Sybil Free Hospital"
                  ]
                },
                "address": {
                  "$ref": "address.schema.1.0.0.json"
                },
                "admissionDate": {
                  "type": "string",
                  "format": "date"
                }
              },
              "required": [
                "accommodationType",
                "accommodationName",
                "admissionDate",
                "address"
              ],
              "additionalProperties": false
            },
            {
              "properties": {
                "accommodationType": {
                  "const": "hospice"
                },
                "accommodationName": {
                  "description": "The name of the hospice",
                  "type": "string",
                  "maxLength": 35,
                  "minLength": 3,
                  "examples": [
                    "St Onan's"
                  ]
                },
                "address": {
                  "$ref": "address.schema.1.0.0.json"
                },
                "admissionDate": {
                  "type": "string",
                  "format": "date"
                }
              },
              "required": [
                "accommodationType",
                "accommodationName",
                "admissionDate",
                "address"
              ],
              "additionalProperties": false
            },
            {
              "properties": {
                "accommodationType": {
                  "const": "carehome"
                },
                "accommodationName": {
                  "description": "The name of the care home",
                  "type": "string",
                  "maxLength": 35,
                  "minLength": 3,
                  "examples": [
                    "Sunshine Sanctuary"
                  ]
                },
                "address": {
                  "$ref": "address.schema.1.0.0.json"
                },
                "admissionDate": {
                  "type": "string",
                  "format": "date"
                }
              },
              "required": [
                "accommodationType",
                "accommodationName",
                "admissionDate",
                "address"
              ],
              "additionalProperties": false
            },
            {
              "properties": {
                "accommodationType": {
                  "const": "other"
                },
                "accommodationName": {
                  "description": "The name of the other accommodation",
                  "type": "string",
                  "maxLength": 35,
                  "minLength": 3,
                  "examples": [
                    "Havelock Vetinari Ward"
                  ]
                },
                "address": {
                  "$ref": "address.schema.1.0.0.json"
                },
                "admissionDate": {
                  "type": "string",
                  "format": "date"
                }
              },
              "required": [
                "accommodationType",
                "accommodationName",
                "admissionDate",
                "address"
              ],
              "additionalProperties": false
            },
            {
              "properties": {
                "accommodationType": {
                  "const": "none"
                }
              },
              "required": [
                "accommodationType"
              ],
              "additionalProperties": false
            }
          ]
        }
      },
      "required": [
        "healthConditions",
        "hcpContactConsent"
      ]
    }
  },
  "required": [
    "additionalSupport",
    "personalDetails",
    "residenceAndPresence",
    "aboutYourHealth"
  ],
  "$defs": {
    "healthProfessionalsDetails": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[ -~]+$",
          "examples": [
            "Miss Medic"
          ],
          "maxLength": 56
        },
        "profession": {
          "type": "string",
          "examples": [
            "GP"
          ]
        },
        "phoneNumber": {
          "type": "string",
          "maxLength": 15,
          "examples": [
            "01234123123"
          ]
        },
        "address": {
          "$ref": "address.schema.1.0.0.json"
        },
        "lastContact": {
          "type": "string",
          "examples": [
            "last week",
            "20th June",
            "about 18 months ago"
          ]
        }
      },
      "required": [
        "name",
        "profession",
        "phoneNumber",
        "address",
        "lastContact"
      ]
    }
  }
}
